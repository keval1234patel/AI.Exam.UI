<ng-container *ngIf="question">
    <div class="bg-white rounded-lg shadow-md border border-gray-200 p-6 h-full min-h-[500px] flex flex-col">
        <!-- Header Badge -->
        <div class="flex justify-between items-center mb-6 border-b border-gray-100 pb-4">
            <span
                class="bg-indigo-100 text-indigo-800 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide flex items-center gap-2">

                <!-- CW -->
                <mat-icon *ngIf="question.questionType === 'CW'" class="w-3 h-3" fontIcon="code"></mat-icon>

                <!-- COP -->
                <mat-icon *ngIf="question.questionType === 'COP'" class="w-3 h-3" fontIcon="terminal"></mat-icon>

                {{ typeLabels[question.questionType] || question.questionType }}
            </span>
<ng-container *ngIf="isVerified">
            <div class="flex items-center px-4 py-1.5 rounded-full text-sm font-bold shadow-sm"
                [ngClass]="isAnswerCorrect ? 'bg-green-100 text-green-700 border border-green-200' : 'bg-red-100 text-red-700 border border-red-200'">

                <!-- Correct -->
                <mat-icon *ngIf="isAnswerCorrect" class="w-4 h-4 mr-1.5" fontIcon="check"></mat-icon>

                <!-- Wrong -->
                <mat-icon *ngIf="!isAnswerCorrect" class="w-4 h-4 mr-1.5" fontIcon="close"></mat-icon>

                {{ isAnswerCorrect ? 'Correct' : 'Incorrect' }}
            </div>
            </ng-container>
        </div>

        <div class="flex-1">
            <!-- Question Text -->
            <div class="mb-8">
                <h2 class="text-lg md:text-xl text-gray-900 leading-relaxed font-medium"
                    [ngClass]="{'font-mono bg-gray-50 p-4 rounded-md border border-gray-200 text-sm whitespace-pre-wrap': isCodeType}">
                    {{ question.q }}
                </h2>
            </div>

            <!-- Options / TF View -->
            <div *ngIf="question.options || question.questionType === 'TF'; else textAnswerView" class="mb-8">
                <h4 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Options</h4>
                <div class="grid grid-cols-1 gap-3 mt-4">
                    <div *ngFor="let opt of displayOptions"
                        class="p-4 rounded-lg border-2 flex justify-between items-center transition-all"
                        [ngClass]="getOptionClass(opt)">
                        <span class="font-medium">{{ opt }}</span>
                        <div *ngIf="getOptionIcon(opt) as iconStatus" [ngSwitch]="iconStatus"
                            class="flex items-center font-bold text-sm">

                                <!-- Correct Choice -->
                                <ng-container *ngSwitchCase="'correct-choice'">
                                    <mat-icon class="w-5 h-5 mr-1" fontIcon="check"></mat-icon>
                                    Your Answer
                                </ng-container>

                                <!-- Missed Correct Answer -->
                                <ng-container *ngSwitchCase="'missed'">
                                    <mat-icon class="w-4 h-4 mr-1" fontIcon="check"></mat-icon>
                                    Correct Answer
                                </ng-container>

                                <!-- Wrong Answer -->
                                <ng-container *ngSwitchCase="'wrong'">
                                    <mat-icon class="w-5 h-5 mr-1" fontIcon="close"></mat-icon>
                                    Your Answer
                                </ng-container>

                            <!-- </ng-container> -->

                        </div>
                    </div>
                </div>
            </div>

            <!-- Text Answer View (Template) -->
            <ng-template #textAnswerView>
                <div class="grid grid-cols-1 xl:grid-cols-2 gap-6 mb-8">
                    <div class="flex flex-col">
                        <h5 class="text-red-700 font-bold mb-2 flex items-center text-sm uppercase tracking-wide">
                            <mat-icon class="w-4 h-4 mr-2" fontIcon="close"></mat-icon>
                            Your Answer
                        </h5>

                        <div class="p-4 rounded-lg border flex-1 whitespace-pre-wrap break-words"
                            [ngClass]="isCodeType ? 'bg-gray-900 text-gray-100 border-gray-700 font-mono text-sm' : 'bg-red-50 border-red-200 text-gray-800'">
                            {{ question.studentAnswer || 'No answer provided' }}
                        </div>
                    </div>

                    <div class="flex flex-col">
                        <h5 class="text-green-700 font-bold mb-2 flex items-center text-sm uppercase tracking-wide">
                            <mat-icon class="w-4 h-4 mr-2" fontIcon="check"></mat-icon>
                            Correct Answer
                        </h5>

                        <div class="p-4 rounded-lg border flex-1 whitespace-pre-wrap break-words"
                            [ngClass]="isCodeType ? 'bg-gray-800 text-green-400 border-gray-700 font-mono text-sm' : 'bg-green-50 border-green-200 text-gray-800'">
                            {{ question.a }}
                        </div>
                    </div>
                </div>
            </ng-template>
        </div>

        <!-- Footer Info -->
        <div class="mt-6 pt-6 border-t border-gray-100">
            <div class="flex items-center gap-3 p-4 bg-gray-50 rounded-lg border border-gray-200">
                <mat-icon class="w-5 h-5 text-gray-500" fontIcon="error_outline"></mat-icon>
                <div class="flex gap-4 text-sm text-gray-600">
                    <p>Score: <span class="font-bold text-gray-900">{{ question.score }}</span></p>
                </div>
            </div>
        </div>
    </div>

</ng-container>